{"remainingRequest":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/src/components/Landing/MarketView/BookPane/LiveTrades/LiveTrades.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/src/components/Landing/MarketView/BookPane/LiveTrades/LiveTrades.vue","mtime":1595618551658},{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chrismoores/Projects/Vega/0x955C6789A7fbee203B4bE0F01428E769308813f2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n\nimport ExchangeDataEventBus from '@/eventBuses/exchangeData';\nimport Spinner from '@/components/Spinner/Spinner.vue';\nimport gql from 'graphql-tag';\n\nexport default {\n  name: 'live-trades',\n\n  components: {\n    Spinner,\n  },\n\n  props: {\n    parentHeight: Number,   //communicated to parent\n  },\n\n  data() {\n    return {\n      trades: {},\n      tableHeight: '',\n      showLoader:false,\n      snapTaken: false,\n      marketId: 'RTJVFCMFZZQQLLYVSXTWEN62P6AH6OCN', //this.$store.state.selectedVegaMarketId,\n      \n    };\n  },\n\n  apollo: {\n    $subscribe: {\n      trades: {\n        query: gql`subscription name($marketId: String!) {\n                  trades (marketId: $marketId) {\n                      market {\n                        id\n                      }\n                      price\n                      size\n                      aggressor\n                      createdAt\n                  }\n                }`,\n\n        variables() {  return {marketId: this.marketId,};  },\n\n        result({data,loading,}) {\n          if (loading) {\n            // console.log('loading');\n          }\n          let _trades = data.trades;\n          //          // console.log(_trades[0].market.id);\n          if (!this.snapTaken) { \n            // // console.log(_trades[0].market.id);\n            //            // console.log(_trades);\n            this.snapshotListener(_trades);\n            this.snapTaken = true;\n          }\n          else {\n            // // console.log(_trades);\n            for (let i=(_trades.length-1); i>=0;i--) {\n              // // console.log(_trades[i]);\n              this.liveTradeListener(_trades[i]);\n            }\n          }\n        },\n      },\n    },\n  },\n\n  watch: {\n    parentHeight: function(newVal) {\n      let calcHeight = newVal;\n      this.tableHeight = 'calc(100vh - ' + (calcHeight  + 100) + 'px';\n    },\n  },\n\n  created() {\n\n    this.snapshotListener = snap => {\n      this.trades = snap;\n      setTimeout(() => {this.showLoader=false;}, 1000);\n      const liveTrade = snap[0];\n      let price;\n      if (liveTrade.aggressor == 'Sell') {\n        price = - Number(liveTrade.price);\n      } \n      else {\n        price = Number(liveTrade.price);\n      }\n      this.$store.commit('liveTradePrice', Math.abs((price/100000).toFixed(5)));\n      this.$store.commit('removeLoaderTask', 1);\n    };\n\n    this.reset = (newMarket) => {\n      this.showLoader=true;\n      this.snapTaken = false;\n      this.trades = {};\n      this.marketId = newMarket.Id;\n      // console.log('New Selected Market being fetched in LiveTrades with Id - ' + this.marketId);\n    };\n\n    this.liveTradeListener = liveTrade => {\n      this.trades.unshift(liveTrade);\n      if (this.trades.length > 100) {\n        this.trades.pop();\n      }\n      let price;\n      if (liveTrade.aggressor == 'Sell') {\n        price = -Number(liveTrade.price);\n      } else {\n        price = Number(liveTrade.price);\n      }\n      this.$store.commit('liveTradePrice', Math.abs((price/100000).toFixed(5)));\n    };\n\n    ExchangeDataEventBus.$on('change-vega-market', this.reset);\n  },\n\n  destroyed() {\n    this.snapTaken = false;\n    ExchangeDataEventBus.$on('change-vega-market', this.reset);\n  },\n  \n};\n",{"version":3,"sources":["LiveTrades.vue"],"names":[],"mappings":";;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA","file":"LiveTrades.vue","sourceRoot":"src/components/Landing/MarketView/BookPane/LiveTrades","sourcesContent":["<template src=\"./template.html\"></template>\n\n<script>\nimport ExchangeDataEventBus from '@/eventBuses/exchangeData';\nimport Spinner from '@/components/Spinner/Spinner.vue';\nimport gql from 'graphql-tag';\n\nexport default {\n  name: 'live-trades',\n\n  components: {\n    Spinner,\n  },\n\n  props: {\n    parentHeight: Number,   //communicated to parent\n  },\n\n  data() {\n    return {\n      trades: {},\n      tableHeight: '',\n      showLoader:false,\n      snapTaken: false,\n      marketId: 'RTJVFCMFZZQQLLYVSXTWEN62P6AH6OCN', //this.$store.state.selectedVegaMarketId,\n      \n    };\n  },\n\n  apollo: {\n    $subscribe: {\n      trades: {\n        query: gql`subscription name($marketId: String!) {\n                  trades (marketId: $marketId) {\n                      market {\n                        id\n                      }\n                      price\n                      size\n                      aggressor\n                      createdAt\n                  }\n                }`,\n\n        variables() {  return {marketId: this.marketId,};  },\n\n        result({data,loading,}) {\n          if (loading) {\n            // console.log('loading');\n          }\n          let _trades = data.trades;\n          //          // console.log(_trades[0].market.id);\n          if (!this.snapTaken) { \n            // // console.log(_trades[0].market.id);\n            //            // console.log(_trades);\n            this.snapshotListener(_trades);\n            this.snapTaken = true;\n          }\n          else {\n            // // console.log(_trades);\n            for (let i=(_trades.length-1); i>=0;i--) {\n              // // console.log(_trades[i]);\n              this.liveTradeListener(_trades[i]);\n            }\n          }\n        },\n      },\n    },\n  },\n\n  watch: {\n    parentHeight: function(newVal) {\n      let calcHeight = newVal;\n      this.tableHeight = 'calc(100vh - ' + (calcHeight  + 100) + 'px';\n    },\n  },\n\n  created() {\n\n    this.snapshotListener = snap => {\n      this.trades = snap;\n      setTimeout(() => {this.showLoader=false;}, 1000);\n      const liveTrade = snap[0];\n      let price;\n      if (liveTrade.aggressor == 'Sell') {\n        price = - Number(liveTrade.price);\n      } \n      else {\n        price = Number(liveTrade.price);\n      }\n      this.$store.commit('liveTradePrice', Math.abs((price/100000).toFixed(5)));\n      this.$store.commit('removeLoaderTask', 1);\n    };\n\n    this.reset = (newMarket) => {\n      this.showLoader=true;\n      this.snapTaken = false;\n      this.trades = {};\n      this.marketId = newMarket.Id;\n      // console.log('New Selected Market being fetched in LiveTrades with Id - ' + this.marketId);\n    };\n\n    this.liveTradeListener = liveTrade => {\n      this.trades.unshift(liveTrade);\n      if (this.trades.length > 100) {\n        this.trades.pop();\n      }\n      let price;\n      if (liveTrade.aggressor == 'Sell') {\n        price = -Number(liveTrade.price);\n      } else {\n        price = Number(liveTrade.price);\n      }\n      this.$store.commit('liveTradePrice', Math.abs((price/100000).toFixed(5)));\n    };\n\n    ExchangeDataEventBus.$on('change-vega-market', this.reset);\n  },\n\n  destroyed() {\n    this.snapTaken = false;\n    ExchangeDataEventBus.$on('change-vega-market', this.reset);\n  },\n  \n};\n</script>\n<style src=\"./style.scss\" lang=\"scss\"  scoped></style>\n"]}]}